:root {
	--stcdx--color: rgb(0, 255, 255);
	--stcdx--icon: "ðŸ§¾";
	--stcdx--mapZoom: 10;
	--stcdx--mapShadow: 3;
	--stcdx--mapShadowColor: rgba(0 0 0 / 1);
	--stcdx--mapDesaturate: 50;

	--stcdx--transitionTime: 400;
	--stcdx--zoomTime: 400;
	--stcdx--mapZoneZoomTime: 400;
}


#shadow_popup {
	&:has(#stcdx--zoneEditor),
	&:has(#stcdx--mapEditor)
	{
		z-index: 10000;
		#stcdx--mapEditor, #stcdx--zoneEditor {
			display: flex;
			flex-direction: column;
			flex: 1 1 auto;
			height: 100%;
			> label:has(#stcdx--map-description), > label:has(#stcdx--zone-description) {
				flex: 1 1 auto;
				display: flex;
				flex-direction: column;
				#stcdx--map-description, #stcdx--zone-description {
					flex: 1 1 auto;
				}
			}
			.stcdx--inputs {
				display: flex;
				align-items: baseline;
			}
		}
	}
}


#stcdx--settings {
	.stcdx--templatesContainer {
		flex: 1 1 auto;
		.stcdx--template {
			border-top: 1px solid var(--SmartThemeBorderColor);
			padding-top: 1em;
			margin-top: 1em;

			>.stcdx--content {
				>.stcdx--row {
					display: flex;
					gap: 0.5em;
				}
			}
		}
	}
}




.stcdx--link {
	cursor: help;
	color: var(--stcdx--color);
	transition: 200ms;
	&:after {
		content: var(--stcdx--icon);
		opacity: 0.5;
	}
	&:hover {
		text-decoration: underline dotted;
		&:after {
			opacity: 1;
		}
	}
}




.stcdx--root {
	display: none;
	grid-template-columns: 100%;
	grid-template-rows: 0fr 1fr;

	background-color: var(--SmartThemeBotMesBlurTintColor);

	position: absolute;
	bottom: 0;
	right: 0;
	top: 0;
	max-height: unset;
	max-width: unset;
	width: calc((100vw - var(--sheldWidth)) / 2);
	transition: calc(1ms * var(--stcdx--transitionTime));

	&.stcdx--active {
		display: grid;
	}
	&.stcdx--maximized {
		width: calc(100vw - var(--nav-bar-width));
		z-index: 1000;
	}

	&.stcdx--isEditing {
		> .stcdx--header {
			> .stcdx--action, > .stcdx--search {
				display: none;
				&.stcdx--edit, &.stcdx--max, &.stcdx--close {
					display: block;
				}
			}
			> .stcdx--editHeader {
				display: block;
			}
		}
	}

	> .stcdx--header {
		flex: 0 0 auto;

		display: flex;
		flex-direction: row;
		justify-content: center;
		align-items: center;
		gap: 1em;

		position: relative;
		height: 2em;

		> .stcdx--action {
			cursor: pointer;
			font-size: 2em;
			padding: 0.2em;
			opacity: 0.5;
			transition: 200ms;
			&:hover {
				opacity: 1;
			}
			&.stcdx--disabled {
				cursor: default;
				opacity: 0.25;
				&:hover {
					opacity: 0.25;
				}
			}

			&.stcdx--menu {
				> .stcdx--books {
					display: none;
					background-color: var(--SmartThemeBotMesBlurTintColor);
					border: 1px solid var(--SmartThemeBorderColor);
					backdrop-filter: blur(var(--SmartThemeBlurStrength));
					border-radius: 10px;
					font-size: 0.5em;
					position: absolute;
					top: 100%;
					left: 0;
					overflow: auto;
					margin: 0;
					padding: 0.5em;
					max-height: 90vh;
					list-style: none;
					z-index: 99999;
					max-width: 100%;
					&.stcdx--active {
						display: block;
					}

					> .stcdx--book {
						> .stcdx--name {
							font-weight: bold;
						}

						> .stcdx--entries {
							list-style: none;
							padding: 0 0.5em 0.5em 0.5em;
							margin: 0;

							> .stcdx--entry {
								cursor: pointer;
								white-space: nowrap;
								overflow: hidden;
								text-overflow: ellipsis;
								opacity: 0.8;
								transition: 200ms;
								&:hover {
									opacity: 1;
								}
							}
						}
					}
				}
			}

			&.stcdx--edit {
				transform: scaleX(-1);
			}

			&.stcdx--drag, &.stcdx--close {
				font-size: 1em;
			}
		}
		> .stcdx--editHeader {
			flex: 1 1 auto;
			display: none;
			text-align: center;
		}
		> .stcdx--search {
			flex: 1 1 auto;
			> .stcdx--searchInput {
				width: 100%;
			}
			> .stcdx--results {
				background-color: var(--SmartThemeBotMesBlurTintColor);
				border: 1px solid var(--SmartThemeBorderColor);
				backdrop-filter: blur(var(--SmartThemeBlurStrength));
				border-radius: 10px;
				position: absolute;
				top: 100%;
				left: 0;
				overflow: auto;
				margin: 0;
				padding: 0.5em;
				max-height: 90vh;
				list-style: none;
				z-index: 99999;
				width: 100%;

				>.stcdx--result {
					opacity: 0.8;
					transition: 200ms;
					cursor: pointer;
					padding: 0.25em;

					&:hover {
						opacity: 1;
					}
				}
			}
		}
	}

	> .stcdx--content, > .stcdx--editor {
		grid-row: 2;
		grid-column: 1;

		z-index: -1;

		height: 100%;
		width: 100%;
		overflow: auto;
		padding: 1em;
		text-align: justify;

		display: none;
		opacity: 0;
		pointer-events: none;
		transition: calc(1ms * var(--stcdx--transitionTime));

		&.stcdx--preactive {
			display: block;
		}
		&.stcdx--active {
			opacity: 1;
			pointer-events: all;
		}
	}
	> .stcdx--content {
		> br {
			display: none;
		}
		h1, h2, h3 {
			text-align: center;
		}
		img {
			cursor: zoom-in;
			height: auto;
			max-height: 50vh;
			object-fit: contain;
			object-position: center;
			transition: 200ms;
			width: 100%;
			&:hover {
				filter: drop-shadow(0 0 6px rgba(0 0 0 / 1));
			}
		}

		&.stcdx--entry {
		}
		&.stcdx--map {
			display: flex;
			flex-direction: column;
			gap: 0.5em;
			height: 100%;
			overflow: hidden;
			> .stcdx--title {
				cursor: zoom-in;
				&:after {
					content: "ðŸ”Žï¸Ž";
					font-size: 0.8em;
					margin-left: 0.5em;
					opacity: 0.5;
					transition: 200ms;
				}
				&:hover:after {
					opacity: 0.9;
				}
			}
			> .stcdx--mapContainer {
				flex: 0 0 auto;
				position: relative;
				cursor: zoom-in;
				&:hover {
					filter: drop-shadow(0 0 6px rgba(0 0 0 / 1));
				}
				> .stcdx--map, > .stcdx--hover {
					max-height: 50vh;
				}
			}
			> .stcdx--zoneContainer {
				flex: 1 1 auto;
				overflow: auto;
				> .stcdx--zone {
					opacity: 0.75;
					transition: 200ms;
					&.stcdx--active {
						opacity: 1;
					}
					> .stcdx--title {
						font-weight: bold;
					}
				}
			}
		}
	}
}




.stcdx--blocker {
	position: fixed;
	inset: 0;
	z-index: 99999;
	backdrop-filter: blur(0px);
	cursor: zoom-out;
	transition: calc(1ms * var(--stcdx--zoomTime));

	&.stcdx--active {
		backdrop-filter: blur(10px);
	}

	> .stcdx--clone {
		position: absolute;
		object-fit: contain;
		object-position: center;
		transition: calc(1ms * var(--stcdx--zoomTime));
	}
}

.stcdx--map-zoomed {
	position: fixed;
	inset: 0;
	height: 100vh;
	width: 100vw;
	z-index: 9999;
	backdrop-filter: blur(0);
	pointer-events: none;
	transition: calc(1ms * var(--stcdx--zoomTime));
	&.stcdx--active {
		backdrop-filter: blur(var(--SmartThemeBlurStrength));
		pointer-events: all;
	}

	> .stcdx--mapContainer {
		position: absolute;
		inset: 0;
		cursor: zoom-out;
		height: 100vh;
		width: 100vw;
		transition: calc(1ms * var(--stcdx--zoomTime));
		> .stcdx--map, > .stcdx--hover {
			position: absolute;
			inset: 0;
			max-height: 100%;
		}
	}
}




.stcdx--mapContainer {
	display: grid;
	> .stcdx--map,
	> .stcdx--hover {
		grid-column: 1;
		grid-row: 1;
		max-width: 100%;
		height: auto;
		width: auto;
		margin: auto;
		z-index: 1;
		filter: saturate(calc(1 - var(--stcdx--mapDesaturate) / 100));

		&.stcdx--map {}

		&.stcdx--hover {
			pointer-events: none;
			transition: transform calc(1ms * var(--stcdx--mapZoneZoomTime)), filter calc(1ms * var(--stcdx--mapZoneZoomTime));

			&.stcdx--hovered {
				transform: scale(calc(1 + var(--stcdx--mapZoom) / 100));
				filter: saturate(1) drop-shadow(0 0 calc(1px * var(--stcdx--mapShadow)) var(--stcdx--mapShadowColor));
				z-index: 2;
			}
		}
	}
}




.stcdx--mapEditor {
	display: flex;
	flex-direction: column;
	backdrop-filter: blur(var(--SmartThemeBlurStrength));
	position: fixed;
	inset: 0;
	z-index: 9999;
	> .stcdx--menu {
		display: flex;
		flex-direction: row;
		gap: 0.5em;
		align-items: baseline;
		justify-content: end;
		background-color: var(--greyCAIbg);
		box-shadow: 0 0 6px rgba(0 0 0 / 0.5);
		height: 2em;
		position: relative;

		> .stcdx--title {
			flex: 1 1 auto;
			text-align: center;
			font-weight: bold;
		}
		> .stcdx--hintList {
			cursor: help;
			flex: 0 0 auto;
			display: flex;
			flex-direction: column;
			gap: 0;
			justify-content: left;
			background-color: var(--greyCAIbg);
			position: relative;
			z-index: 10;
			height: 2em;
			overflow: hidden;
			&:hover {
				overflow: visible;
			}
			> .stcdx--hint {
				font-size: smaller;
				padding: 0.5em;
				background-color: var(--greyCAIbg);
			}
		}
		> .stcdx--actions {
			flex: 0 0 auto;
			display: flex;
			flex-direction: row;
			gap: 0.5em;
			padding-left: 1em;
			> .menu_button {
				margin: 0;
				height: 2em;
			}
		}

	}
	> .stcdx--mapContainer {
		position: relative;
		height: 100%;
		width: 100%;
		> .stcdx--map, > .stcdx--hover {
			max-height: 100%;
			inset: 0;
			position: absolute;
		}
	}
}
